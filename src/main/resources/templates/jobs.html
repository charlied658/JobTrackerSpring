<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>All Jobs</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script th:inline="javascript">
        function toggleServices(jobId) {
            const section = document.getElementById("services-" + jobId);
            const btn = document.getElementById("toggle-btn-" + jobId);
            if (section.style.display === "none") {
                section.style.display = "block";
                btn.textContent = "Hide Services â–²";
            } else {
                section.style.display = "none";
                btn.textContent = "Show Services â–¼";
            }
        }
    </script>
</head>
<nav style="margin-bottom: 20px;">
    <span style="color: gray;">ðŸ“‹ Jobs by Customer</span> |
    <a href="/view/scheduler">ðŸ“… Calendar View</a>
</nav>
<body>
<h1>All Jobs</h1>
<ul>
    <li th:each="job : ${jobs}">
        <div>
            <strong th:text="${job.jobNumber}">Job Number</strong> â€“
            <a th:href="@{/jobs/{id}(id=${job.id})}" th:text="${job.customer}">Customer</a>
            <button
                    th:id="'toggle-btn-' + ${job.id}"
                    th:onclick="'toggleServices(' + ${job.id} + ')'">
                Show Services â–¼
            </button>
        </div>

        <ul th:id="'services-' + ${job.id}" style="display: none;">
            <li th:each="service : ${job.services}">
                <span th:text="${#temporals.format(service.date, 'MM/dd/yyyy')}">Date</span> â€“
                <span th:text="${service.workPerformed}">Work</span> â†’
                <em th:text="${service.need}">Need</em>
            </li>
        </ul>
    </li>
</ul>
</body>
</html>