<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>All Customers</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="container">
    <nav style="margin-bottom: 20px;">
        <span style="color: gray;">Customers</span> |
        <a href="/view/jobs">Jobs</a> |
        <a href="/view/services">Services</a>
    </nav>

    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search customers..." onkeyup="filterCustomers()" />
    </div>

    <a class ="box-link" id = "openAddCustomerModal">
        <div class = "add-clickable-box">
            <div class="circle-plus">+</div>
            <span>Add Customer</span>
        </div>
    </a>

    <div class="customer-list">
        <section class="customer-item" th:each="customer : ${customers}">
            <a class="box-link" th:href="@{/view/customers/{id}(id=${customer.id})}">
                <div class = "clickable-box">
                    <h2 th:text="${customer.name}"></h2>
                </div>
            </a>
        </section>
    </div>

</div>
</body>

<div id="addCustomerModalOverlay" class="modal-overlay" style="display: none;">
    <div class="modal">
        <span class="close-button" onclick="closeAddCustomerModal()">&times;</span>
        <h2>Add New Customer</h2>
        <form id="addCustomerForm" method="post" th:action="@{/customers/add}">
            <label for="customerName">Name:</label><br>
            <input type="text" id="customerName" name="name" required><br>

            <label for="customerBusiness">Business:</label><br>
            <input type="text" id="customerBusiness" name="business"><br>

            <label for="customerPhone">Phone:</label><br>
            <input type="text" id="customerPhone" name="phone"><br>

            <label for="customerEmail">Email:</label><br>
            <input type="text" id="customerEmail" name="email"><br>

            <label for="customerAddress">Address:</label><br>
            <input type="text" id="customerAddress" name="address"><br>

            <button type="submit">Save</button>
        </form>
    </div>
</div>

<script>
    function filterCustomers() {
        const query = document.getElementById("searchInput").value.toLowerCase();
        const items = document.querySelectorAll(".customer-item");

        items.forEach(item => {
            const name = item.textContent.toLowerCase();
            item.style.display = name.includes(query) ? "" : "none";
        });
    }
</script>

<script>
    const modalOverlay = document.getElementById("addCustomerModalOverlay");

    document.getElementById("openAddCustomerModal").addEventListener("click", () => {
        modalOverlay.style.display = "flex";
    });

    function closeAddCustomerModal() {
        modalOverlay.style.display = "none";
    }
</script>

</html>